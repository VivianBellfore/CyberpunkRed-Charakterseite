<!DOCTYPE html>
<html>
<head>
	<!-- Nicht ändern. Hier wird die formatierung der Seite geladen. -->
	<meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1">
	<!-- Im "_data" Ordner befindet sich die Datei "styles.css". In dieser Datei sind die Styles für alle Seiten angegeben. Änderungen werden automatisch auf alle Seiten übertragen. -->
	<link rel="stylesheet" href="system/styles.css">

	<!-- Hier wird die Größe der Knöpfe und des Nummernfeldes festgelegt. -->
	<style>
		button {
			margin: 5px;
			padding: 5px 10px;
		}
		input[type="number"] {
			width: 80px;
		}
	</style>
</head>
	
	
<body>
	<!-- Style der custom alert box, am besten nichts dran ändern. -->
	<div id="customAlert" style="display:none; position:fixed; top:30%; left:50%; transform:translateX(-50%);
		background:#000; color:#fff; padding:20px 30px; border:2px solid #fff; border-radius:12px;
		box-shadow:0 4px 15px rgba(255,255,255,0.3); z-index:1000; text-align:center; font-family:sans-serif;">
		<h3 id="customAlertTitle" style="margin-top:0;">Hinweis</h3>
		<p id="customAlertText"></p>
		<button onclick="closeCustomAlert()" style="margin-top:15px; padding:8px 16px; border:none;
			background:#fff; color:#000; border-radius:8px; font-weight:bold; cursor:pointer;">
			OK
		</button>
	</div>

	<!-- Die "sidebar" ist der linke Rand aller Seiten den wir vordefiniert haben in "styles.css". Dort befindet sich das Navigationsmenü um durch die Seiten klicken zu können. -->
	<div class="sidebar">
		<sidebar-menu></sidebar-menu>
		<script src="system/sidebarMenu.js"></script>
	</div>



	<!-- Das "main" ist der eigentliche Bereich der Seiten in denen deren Inhalt neben der sidebar angezeigt wird. Jeder Seiteninhalt muss als innerhalb dieser Klasse stehen. -->
	<div class="main">
		<!-- Mit <br> wird ein Zeilenumbruch und somit ein Abstand erzeugt. -->
		<br>
		<!-- <h1> ist eine Textformatierungen für Überschriften. -->
		<h1>Geld & Ausgaben</h1>
		<!-- <b> ist eine Textformatierung um Text fett darzustellen. -->
		<!-- Mit <strong id="moneyDisplay"> wird die Variable aus einer XML Datei durch eine javascript Funktion ausgelesen. Ist keine XML geladen, wird nur 0 angezeigt. -->
		<b>Kontostand</b>: <strong id="moneyDisplay" style="color: #317256;">0</strong>

		<br><br>

		<!-- Hier wird die Zahl festgelegt die standartmäßig im Zahlenfeld für das Geld angezeigt wird. -->
		<input type="number" id="amount" value="">
		<!-- Darstellung und Beschriftung des Knopfes um das Geld zu erhöhen. -->
		<button onclick="addMoney()">+</button>
		<!-- Darstellung und Beschriftung des Knopfes um das Geld zu verringern. -->
		<button onclick="removeMoney()">-</button>

		<br><br><br>

		<!-- Hier beginnt die Tabelle für Kostenausgaben. -->
		<table id="myTable" style="width:35%">
			<tr class="header">
				<th>Posten</th>
				<th><center>Summe</center></th>
			</tr>
			<!-- Um weitere Kostenpunkte einzutragen, kopiere einfach den ersten Table hier drunter von <tr> bis </tr> und ändere die Eintragungen. -->
			<tr>
				<td>Apartment</td>				<!-- Bezeichnung des Kostenpunktes. -->
				<td><center>300</center></td>	<!-- Zu zahlende Summe. -->
			</tr>
			<tr>
				<td>Kibble</td>					<!-- Bezeichnung des Kostenpunktes. -->
				<td><center>100</center></td>	<!-- Zu zahlende Summe. -->
			</tr>
			<!-- Lasse die erste Zeile frei und addiere alle Kosten zusammen für die zweite Zeile. -->
			<tr>
				<td>Monatliche Ausgaben gesammt</td>
				<td style="color:#b3453b;"><center>-400</center></td> <!-- Trage hier die gesamte monatlich zu zahlende Summ ein! -->
			</tr>
		</table>

		<br><br><br>

		<!-- Hier beginnt die Tabelle für deine Waffen. -->
		<h1>Waffen</h1>
		<table id="myTable">
			<tr class="header">
				<th>Name</th>							<!-- Name der Waffe. -->
				<th><center>Ausgerüstet</center></th>   <!-- Ist das Rüstungsteil ausgerüstet? -->
				<th><center>Anzahl</center></th>		<!-- Anzahl im Besitz. -->
				<th>Typ</th>							<!-- Typ der Waffe. -->
				<th><center>AF</center></th>			<!-- Angriffsfolge der Waffe. -->
				<th><center>Hände</center></th>			<!-- Benötigte Hände zum nutzen. -->
				<th><center>Magazin</center></th>		<!-- Magazingtöße der Waffe. -->
				<th><center>Schaden</center></th>		<!-- Schaden der Waffe. -->
				<th><center>Verbergen</center></th>		<!-- Kann verborgen werden? -->
				<th><center>Qualität</center></th>		<!-- Die Qualität der Waffe. -->
				<th><center>Anbauteile</center></th>	<!-- Welche Anbauteile hat die Waffe. -->
			</tr>
			<!-- Um weitere Waffen einzutragen, kopiere einfach den ersten Table hier drunter von <tr> bis </tr> und ändere die Eintragungen. -->
			<tr>
				<td>Schwere Pistole</td> 							<!-- Name der Waffe. -->
				<td><center>✔️</center></td> 						<!-- Wenn ausgerüstet ✔️ nutzen. -->
				<td><center>1</center></td>                         <!-- Anzahl im Besitz. -->
				<td>Schwere Pistole</td>                            <!-- Typ der Waffe. -->
				<td><center>2</center></td>                         <!-- Angriffsfolge der Waffe. -->
				<td><center>1</center></td>                         <!-- Benötigte Hände zum nutzen. -->
				<td><center>8</center></td>                         <!-- Magazingtöße der Waffe. -->
				<td><center>3W6 + 1 (Qualität)</center></td>        <!-- Schaden der Waffe. -->
				<td><center>Ja</center></td>                        <!-- Kann verborgen werden? -->
				<td><center>Kostspielig</center></td>               <!-- Die Qualität der Waffe. -->
				<td><center>Schalldämpfer (Premium)</center></td>	<!-- Welche Anbauteile hat die Waffe. -->
			</tr>
		</table>

		<br><br><br>

		<h1>Rüstungen</h1>
		<!-- Hier beginnt die Tabelle für deine Rüsungen. -->
		<table id="myTable">
			<tr class="header">
				<th>Name</th>							<!-- Name der Rüstung. -->
				<th><center>Ausgerüstet</center></th>   <!-- Ist das Rüstungsteil ausgerüstet? -->
				<th><center>Anzahl</center></th>        <!-- Anzahl im Besitz. -->
				<th><center>Typ</center></th>           <!-- Wo wird die Rüstung getragen?. -->
				<th><center>SW</center></th>            <!-- Schutzwert -->
				<th><center>Malus</center></th>         <!-- Panzerungsmalus -->
			</tr>
			<!-- Um weitere Rüstungsteile einzutragen, kopiere einfach den ersten Table hier drunter von <tr> bis </tr> und ändere die Eintragungen. -->
			<tr>
				<td>Leichter Panzeranzug</td> 		<!-- Name der Rüstung. -->
				<td><center>✔️</center></td> 		<!-- Wenn ausgerüstet ✔️ nutzen. -->
				<td><center>1</center></td> 		<!-- Anzahl im Besitz. -->
				<td><center>Körper</center></td> 	<!-- Wo wird die Rüstung getragen?. -->
				<td><center>11</center></td> 		<!-- Schutzwert -->
				<td><center>-</center></td> 		<!-- Panzerungsmalus -->
			</tr>
		</table>

		<br><br><br>

		<!-- Hier beginnt die Tabelle für deine Gegenstände. Diese Tabelle hat zusätzlich eine Suchfunktion. -->
		<h1>Gegenstände</h1>
		<input type="text" id="myInput" onkeyup="itemTableFunction()" placeholder="Gib einen Namen ein..." title="Type in a name">
		<table id="tableItems">
			<tr class="header">
				<th>Name</th>
				<th><center>Anzahl</center></th>
				<th>Beschreibung</th>
			</tr>
			<!-- Um weitere Gegenstände einzutragen, kopiere einfach den ersten Table hier drunter von <tr> bis </tr> und ändere die Eintragungen. -->
			<tr>
				<td>Agent</td> 						<!-- Name des Gegenstandes -->
				<td><center>1</center></td> 		<!-- Anzahl im Besitz -->
				<td>AI gesteuertes Smartphone.</td> <!-- Beschreibung -->
			</tr>
			<tr>
				<td>VR Brille</td> 										<!-- Name des Gegenstandes -->
				<td><center>1</center></td> 							<!-- Anzahl im Besitz -->
				<td>Brille um NET Oberflächen sehen zu können.</td> 	<!-- Beschreibung -->
			</tr>
		</table>

		<br><br><hr><br><br>

		<!-- Knopf um Daten zu laden. Fragt immer ab, von wlecher Datei geladen werden soll. -->
		<button onclick="document.getElementById('fileInput').click()">Daten laden</button>
		<!-- Knopf um Daten zu speichern, es wird eine neue XML Datei im Downloadordner erstellt. -->
		<button onclick="saveAsXML()">Daten speichern</button>

		<!-- Blendet die Box für den Suchverlauf aus, wir haben stattdessen einen eigenen Knopf dafür gebaut, da man sonst die Beschriftung nicht ändern kann. -->
		<input type="file" id="fileInput" accept=".xml" style="display: none;">
		<!-- Selbst gebauter Knopf zum ändern der XML Datei, damit auch die Beschriftung angepasst werden kann. -->
		<button onclick="document.getElementById('fileInput').click()">Wähle die XML Datei aus...</button>



		<!-- Ab hier werden javascript Funktionen erstellt. Nichts verändern wenn du kein javascript kannst! -->
		<script>

			// Diese Funktion verwaltet die Suchfunktion in der Itemliste.
			function itemTableFunction() {
				var input, filter, table, tr, td, i, txtValue;
				input = document.getElementById("myInput");
				filter = input.value.toUpperCase();
				table = document.getElementById("tableItems");
				tr = table.getElementsByTagName("tr");
				for (i = 0; i < tr.length; i++) {
					td = tr[i].getElementsByTagName("td")[0];
					if (td) {
						txtValue = td.textContent || td.innerText;
						if (txtValue.toUpperCase().indexOf(filter) > -1) {
							tr[i].style.display = "";
						} else {
							tr[i].style.display = "none";
						}
					}
				}
			}

			// Hier werden initzial die Datenstrukturen für die XML geladen, bitte nichts ändern hier!
			let money = parseInt(localStorage.getItem("money")) || 0;
			updateDisplay();
			function updateDisplay() {
				document.getElementById("moneyDisplay").textContent = money;
			}

			// Funktion die beim "+" Knopf drücken das Geld hinzufügt.
			function addMoney() {
				const amount = parseInt(document.getElementById("amount").value) || 0;
				money += amount;
				localStorage.setItem("money", money);
				updateDisplay();
			}

			// Funktion die beim "-" Knopf das Geld abzieht.
			function removeMoney() {
				const amount = parseInt(document.getElementById("amount").value) || 0;
				money -= amount;
				localStorage.setItem("money", money);
				updateDisplay();
			}

			// Funktion um die Daten als neue XML Datei auf deinen PC zu speichern.
			function saveAsXML() {
				const xmlContent = `<?xml version="1.0" encoding="UTF-8"?>
									<datastruct>
										<money>${money}</money>
									</datastruct>`;
				const blob = new Blob([xmlContent], { type: "text/xml" });
				const link = document.createElement("a");
				link.href = URL.createObjectURL(blob);
				link.download = "data.xml";
				link.click();
			}

			// Importieren von der XML Datei die angegeben wurde.
			document.getElementById("fileInput").addEventListener("change", function (event) {
				const file = event.target.files[0];
				if (!file) return;

				const reader = new FileReader();
				reader.onload = function (e) {
					const parser = new DOMParser();
					const xml = parser.parseFromString(e.target.result, "text/xml");
					const moneyNode = xml.getElementsByTagName("money")[0];
					if (moneyNode) {
						money = parseInt(moneyNode.textContent);
						localStorage.setItem("money", money);
						updateDisplay();
						showCustomAlert("✅ Erfolg", "Daten wurden erfolgreich geladen!"); // Hier steht der Text der Box die sich öffnet, wenn eine XML geladen wurde.
					} else {
						showCustomAlert("❌ Fehler", "Ungültiges XML Format! Prüfe ob du die richtige Datei geladen hast, sie muss das exakte Format wie im Guthub Repo haben."); // Text wenn ein Fehler beim Laden passiert ist.
					}
				};
				reader.readAsText(file);
			});

			// Öffnet ein popup Fenster mit einer show alert box.
			function showCustomAlert(title, message) {
				document.getElementById("customAlertTitle").textContent = title;
				document.getElementById("customAlertText").textContent = message;
				document.getElementById("customAlert").style.display = "block";
			}

			// Schließt ein popup Fenster mit einer show alert box.
			function closeCustomAlert() {
				document.getElementById("customAlert").style.display = "none";
			}
		</script>
	</div>
</body>
</html>